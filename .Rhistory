source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
##########################################
library(lmtest)
library(caret)
library(Metrics)
library(leaps)
library(CombMSC)
function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE,
logical.return = FALSE, warn.conflicts, quietly = FALSE,
verbose = getOption("verbose"), mask.ok, exclude, include.only,
attach.required = missing(include.only))
setwd("/Users/tungb/Desktop/ai-midterm")
AIC(best_model)
BIC(best_model)
Cp(best_model)
BIC(bestsubset_model)
############################################
# CS440 Midterm Project: Tuan Anh Vu, Tung Truong
##########################################
library(lmtest)
library(caret)
library(Metrics)
library(leaps)
library(CombMSC)
setwd("/Users/tungb/Desktop/ai-midterm")
suidat <- read.csv("/Users/tungb/Desktop/ai-midterm/SuiRate.csv")
head(suidat)
names(suidat)[1] <- "SuiRate"
#Suicide Rate Data + Variables:
#https://drive.google.com/open?id=1JFalYrbit84vgHNzYlsCnm0j2AOKyz0D#
# Split data randomly into training set and test set, each with 75% and 25% of the data respectively
set.seed(3456)
trainData <- createDataPartition(suidat$SuiRate, p=.75,list=FALSE,times=1)
suiTrain <- suidat[trainData,]
suiTest <- suidat[-trainData,]
head(suiTrain)
head(suiTest)
###Linear Response
plot(suiTrain$Unemp,suiTrain$SuiRate)
plot(suiTrain$Vet,suiTrain$SuiRate)
plot(suiTrain$Arrest,suiTrain$SuiRate)
plot(suiTrain$Mental,suiTrain$SuiRate)
plot(suiTrain$Disable,suiTrain$SuiRate)
plot(suiTrain$Uninsured,suiTrain$SuiRate)
plot(suiTrain$Poverty,suiTrain$SuiRate)
############################################################
# Best-subset Method
############################################################
best_subsets <- regsubsets(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, nbest = 1, nvmax= 7, data=suiTrain,method="exhaustive")
summary_best<- summary(best_subsets)
which.max(summary_best$adjr2)
bestsubset_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suiTrain)
linear_model <- lm(SuiRate~Vet + Arrest + Mental, data = suiTrain)
summary(linear_model)
############################################################
# Cross - Validated Error
############################################################
lmFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm")
ctrl<-trainControl(method = "cv",number = 10)
lmCVFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm", trControl = ctrl, metric="RMSE")
summary(lmCVFit)
bestkfold_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
summary(bestkfold_model)
############################################################
# Interaction Term Analysis
############################################################
best_uxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxa, data = suiTrain)
summary(best_uxa)
best_uxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxm, data = suiTrain)
summary(best_uxm)
best_uxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxd, data = suiTrain)
summary(best_uxd)
best_uxv <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxv, data = suiTrain)
summary(best_uxv)
best_uxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxu, data = suiTrain)
summary(best_uxu)
best_vxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxa, data = suiTrain)
summary(best_vxa)
best_vxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxm, data = suiTrain)
summary(best_vxm)
best_vxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain)
summary(best_vxd)
best_vxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxu, data = suiTrain)
summary(best_vxu)
best_axm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axm, data = suiTrain)
summary(best_axm)
best_axd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axd, data = suiTrain)
summary(best_axd)
best_axu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axu, data = suiTrain)
summary(best_axu)
best_mxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxd, data = suiTrain)
summary(best_mxd)
best_mxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxu, data = suiTrain)
summary(best_mxu)
best_dxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
summary(best_dxu)
# The interaction term between the disable and uninsured variable increased the adjusted R square while keeping all variables statistically significant
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
summary(best_model)
#Error term analysis
####################
error_terms <- best_model$residuals # from the fit
#All the error terms
suiTrain$SuiRate - predict(best_model, suiTrain)
### Errors independent and and variance about the same
plot(error_terms)
lmtest::bptest(best_model)
###Approximately Normal?
hist(error_terms)
qqnorm(error_terms)
qqline(error_terms)
############################################################
# Cross - Validated Error
############################################################
lmFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain, method = "lm")
ctrl<-trainControl(method = "cv",number = 10)
lmCVFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured+dxu, data = suiTrain, method = "lm", trControl = ctrl, metric="RMSE")
summary(lmCVFit)
bestkfold_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
summary(bestkfold_model)
###############
# Prediction in R
###########
predict(best_model, suiTest)
suiTest$SuiRate - predict(best_model, suiTest)
# Calculate mean and standard deviation for test and training residuals
mean(suiTest$SuiRate - predict(best_model, suiTest))
sd(suiTest$SuiRate - predict(best_model, suiTest))
mean(suiTrain$SuiRate - predict(best_model, suiTrain))
sd(suiTrain$SuiRate - predict(best_model, suiTrain))
rmse(suiTest$SuiRate, predict(best_model, suiTest))
sse(suiTest$SuiRate, predict(best_model, suiTest))
mae(suiTest$SuiRate, predict(best_model, suiTest))
# Determine observation range between training and test set
min(suiTrain$SuiRate)
max(suiTrain$SuiRate)
min(suiTest$SuiRate)
max(suiTest$SuiRate)
#comparison
AIC(best_model)
BIC(best_model)
Cp(best_model)
AIC(bestkfold_model)
BIC(bestkfold_model)
AIC(bestsubset_model)
BIC(bestsubset_model)
AIC(linear_model)
BIC(linear_model)
summary(best_model)
Cp(best_model)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
Cp(best_model,a=1,b=0)
AIC(bestkfold_model)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
Cp(best_model,s2=1,b=0)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
Cp(best_model)
Cp()
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
Cp(a=0,b=1)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
Cp(best_model,a=0,b=1)
Cp(best_model,a=0,b=1)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
Cp(best_model,s2= bestkfold_model,a=0,b=1)
AIC(bestkfold_model)
Cp(best_model,s2=bestkfold_model,a=0,b=1)
#comparison
AIC(best_model)
BIC(best_model)
AIC(bestkfold_model)
BIC(bestkfold_model)
AIC(bestsubset_model)
BIC(bestsubset_model)
AIC(linear_model)
BIC(linear_model)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
BIC(bestsubset_model)
ibrary(CombMSC)
library(CombMSC)
AIC(best_model)
BIC(best_model)
AIC(bestkfold_model)
BIC(bestkfold_model)
AIC(bestsubset_model)
BIC(bestsubset_model)
AIC(linear_model)
BIC(linear_model)
BIC(best_model)
############################################
# CS440 Midterm Project: Tuan Anh Vu, Tung Truong
##########################################
library(lmtest)
library(caret)
library(Metrics)
library(leaps)
library(CombMSC)
setwd("/Users/tungb/Desktop/ai-midterm")
suidat <- read.csv("/Users/tungb/Desktop/ai-midterm/SuiRate.csv")
head(suidat)
names(suidat)[1] <- "SuiRate"
#Suicide Rate Data + Variables:
#https://drive.google.com/open?id=1JFalYrbit84vgHNzYlsCnm0j2AOKyz0D#
# Split data randomly into training set and test set, each with 75% and 25% of the data respectively
set.seed(3456)
trainData <- createDataPartition(suidat$SuiRate, p=.75,list=FALSE,times=1)
suiTrain <- suidat[trainData,]
suiTest <- suidat[-trainData,]
head(suiTrain)
head(suiTest)
###Linear Response
plot(suiTrain$Unemp,suiTrain$SuiRate)
plot(suiTrain$Vet,suiTrain$SuiRate)
plot(suiTrain$Arrest,suiTrain$SuiRate)
plot(suiTrain$Mental,suiTrain$SuiRate)
plot(suiTrain$Disable,suiTrain$SuiRate)
plot(suiTrain$Uninsured,suiTrain$SuiRate)
plot(suiTrain$Poverty,suiTrain$SuiRate)
############################################################
# Best-subset Method
############################################################
best_subsets <- regsubsets(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, nbest = 1, nvmax= 7, data=suiTrain,method="exhaustive")
summary_best<- summary(best_subsets)
which.max(summary_best$adjr2)
bestsubset_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suiTrain)
linear_model <- lm(SuiRate~Vet + Arrest + Mental, data = suiTrain)
summary(linear_model)
############################################################
# Cross - Validated Error
############################################################
lmFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm")
ctrl<-trainControl(method = "cv",number = 10)
lmCVFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm", trControl = ctrl, metric="RMSE")
summary(lmCVFit)
bestkfold_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
summary(bestkfold_model)
############################################################
# Interaction Term Analysis
############################################################
best_uxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxa, data = suiTrain)
summary(best_uxa)
best_uxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxm, data = suiTrain)
summary(best_uxm)
best_uxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxd, data = suiTrain)
summary(best_uxd)
best_uxv <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxv, data = suiTrain)
summary(best_uxv)
best_uxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxu, data = suiTrain)
summary(best_uxu)
best_vxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxa, data = suiTrain)
summary(best_vxa)
best_vxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxm, data = suiTrain)
summary(best_vxm)
best_vxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain)
summary(best_vxd)
best_vxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxu, data = suiTrain)
summary(best_vxu)
best_axm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axm, data = suiTrain)
summary(best_axm)
best_axd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axd, data = suiTrain)
summary(best_axd)
best_axu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axu, data = suiTrain)
summary(best_axu)
best_mxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxd, data = suiTrain)
summary(best_mxd)
best_mxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxu, data = suiTrain)
summary(best_mxu)
best_dxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
summary(best_dxu)
# The interaction term between the disable and uninsured variable increased the adjusted R square while keeping all variables statistically significant
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
summary(best_model)
#Error term analysis
####################
error_terms <- best_model$residuals # from the fit
#All the error terms
suiTrain$SuiRate - predict(best_model, suiTrain)
### Errors independent and and variance about the same
plot(error_terms)
lmtest::bptest(best_model)
###Approximately Normal?
hist(error_terms)
qqnorm(error_terms)
qqline(error_terms)
############################################################
# Cross - Validated Error
############################################################
lmFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain, method = "lm")
ctrl<-trainControl(method = "cv",number = 10)
lmCVFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured+dxu, data = suiTrain, method = "lm", trControl = ctrl, metric="RMSE")
summary(lmCVFit)
bestkfold_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
summary(bestkfold_model)
###############
# Prediction in R
###########
predict(best_model, suiTest)
suiTest$SuiRate - predict(best_model, suiTest)
# Calculate mean and standard deviation for test and training residuals
mean(suiTest$SuiRate - predict(best_model, suiTest))
sd(suiTest$SuiRate - predict(best_model, suiTest))
mean(suiTrain$SuiRate - predict(best_model, suiTrain))
sd(suiTrain$SuiRate - predict(best_model, suiTrain))
rmse(suiTest$SuiRate, predict(best_model, suiTest))
sse(suiTest$SuiRate, predict(best_model, suiTest))
mae(suiTest$SuiRate, predict(best_model, suiTest))
# Determine observation range between training and test set
min(suiTrain$SuiRate)
max(suiTrain$SuiRate)
min(suiTest$SuiRate)
max(suiTest$SuiRate)
#comparison
AIC(best_model)
BIC(best_model)
AIC(bestkfold_model)
BIC(bestkfold_model)
AIC(bestsubset_model)
BIC(bestsubset_model)
AIC(linear_model)
BIC(linear_model)
BIC.fmo(best_model)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
BIC(best_model)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
library(CombMSC)
BIC(best_model)
typeof(best_model)
BIC(bestsubset_model)
BIC(bestkfold_model)
BIC(lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)l)
BIC(lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain))
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
Adj.Rsq.lm(best_model)
Adj.Rsq(best_model)
summary(best_model)
Adj.Rsq.fmo(best_model)
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
summary(best_model)
Adj.Rsq(best_model)
BIC(best_model)
BIC(best_axd)
BIC(best_axd)
BIC(lm(best_axd))
BIC(as.lm(best_axd))
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
BIC(as.lm(best_axd))
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
source('C:/Users/tungb/Desktop/ai-midterm/midterm.R')
