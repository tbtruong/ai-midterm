setwd("/Users/BenMeow/Desktop/Midterm/ai-midterm")
suidat <- read.csv("/Users/BenMeow/Desktop/Midterm/ai-midterm/SuiRate.csv")
head(suidat)
#Suicide Rate Data + Variables:
#https://drive.google.com/open?id=1JFalYrbit84vgHNzYlsCnm0j2AOKyz0D#
# Split data randomly into training set and test set, each with 75% and 25% of the data respectively
set.seed(3456)
trainData <- createDataPartition(suidat$SuiRate, p=.75,list=FALSE,times=1)
suiTrain <- suidat[trainData,]
suiTest <- suidat[-trainData,]
head(suiTrain)
head(suiTest)
# Best subset:
best_subsets <- regsubsets(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, nbest = 1, nvmax= 7, data=suiTrain,method="exhaustive")
summary_best<- summary(best_subsets)
which.max(summary_best$adjr2)
bestest_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Uninsured + Poverty, data = suidat)
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Uninsured + Poverty, data = suidat)
summary(best_model)
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat)
summary(best_model)
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
summary(best_model)
lmFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm")
ctrl<-trainControl(method = "cv",number = 10)
lmCVFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm", trControl = ctrl, metric="RMSE")
summary(lmCVFit)
plot(suiTrain$Poverty,suiTrain$SuiRate)
plot(suiTrain$Uninsured,suiTrain$SuiRate)
suidat <- read.csv("/Users/BenMeow/Desktop/Midterm/ai-midterm/SuiRate.csv")
View(ctrl)
summary(best_model)
best_uxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxa, data = suiTrain)
summary(best_uxa)
best_uxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxm, data = suiTrain)
summary(best_uxm)
best_uxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxd, data = suiTrain)
summary(best_uxd)
best_uxv <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxv, data = suiTrain)
summary(best_uxv)
best_uxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxu, data = suiTrain)
suidat <- read.csv("/Users/BenMeow/Desktop/Midterm/ai-midterm/SuiRate.csv")
best_uxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxu, data = suiTrain)
set.seed(3456)
trainData <- createDataPartition(suidat$SuiRate, p=.75,list=FALSE,times=1)
suiTrain <- suidat[trainData,]
suiTest <- suidat[-trainData,]
head(suiTrain)
head(suiTest)
best_uxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxu, data = suiTrain)
summary(best_uxx)
summary(best_uxu)
best_vxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxa, data = suiTrain)
summary(best_vxa)
best_vxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxm, data = suiTrain)
summary(best_vxm)
best_vxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain)
summary(best_vxd)
best_vxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxu, data = suiTrain)
summary(best_vxu)
best_axm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axm, data = suiTrain)
summary(best_axm)
best_axd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axd, data = suiTrain)
summary(best_axd)
best_axu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axu, data = suiTrain)
summary(best_axu)
best_mxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxd, data = suiTrain)
summary(best_mxd)
best_mxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxu, data = suiTrain)
summary(best_mxu)
best_dxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
summary(best_dxu)
summary(best_model)
summary(bestest_model)
bestest_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
summary(bestest_model)
bestest_dxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured +dxu, data = suidat)
summary(dxu)
summary(bestest_dxu)
best_mxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxu, data = suiTrain)
summary(bestest_dxu)
bestest_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured +dxu, data = suiTrain)
summary(bestest_model)
which.max(summary_best$adjr2)
View(summary_best)
summary_best[["which"]]
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured +dxu, data = suiTrain)
summary(best_model)
#Error term analysis
####################
error_terms <- best_model$residuals # from the fit
### Errors independent and and variance about the same
plot(error_terms)
lmtest::bptest(best_model)
###Approximately Normal?
hist(error_terms)
qqnorm(error_terms)
qqline(error_terms)
###############
# Prediction in R
###########
predict(best_model, suiTest)
suiTest$SuiRate - predict(best_model, suiTest)
# Calculate mean and standard deviation for test and training residuals
mean(suiTest$SuiRate - predict(best_model, suiTest))
sd(suiTest$SuiRate - predict(best_model, suiTest))
mean(suiTrain$SuiRate - predict(best_model, suiTrain))
sd(suiTrain$SuiRate - predict(best_model, suiTrain))
rmse(suiTest$SuiRate, predict(best_model, suiTest))
sse(suiTest$SuiRate, predict(best_model, suiTest))
mae(suiTest$SuiRate, predict(best_model, suiTest))
# Determine observation range between training and test set
min(suiTrain$SuiRate)
max(suiTrain$SuiRate)
min(suiTest$SuiRate)
max(suiTest$SuiRate)
lmtest::bptest(best_model)
bestsubset_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suiTrain)
summary(bestsubset_model)
lmtest::bptest(bestsubset_model)
bestkfold_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
lmtest::bptest(bestkfold_model)
### Errors independent and and variance about the same
plot(error_terms)
bartlett.test(best_model)
bartlett.test(best_model, suiTrain)
bartlett.test(best_model, data = suiTrain)
bartlett.test(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain, )
bartlett.test(SuiRate ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain )
bartlett.test(list(best_model)
bartlett.test(list(best_model)
bartlett.test(list(best_model))
bartlett.test(list(best_model,bestsubset_model))
bartlett.test(list(SuiRate~Unemp,SuiRate~Vet,SuiRate~Arrest,SuiRate~Mental,SuiRate~Disable,SuiRate~Uninsured,SuiRate~dxu,))
bartlett.test(list(SuiRate~Unemp,SuiRate~Vet,SuiRate~Arrest,SuiRate~Mental,SuiRate~Disable,SuiRate~Uninsured,SuiRate~dxu))
lmtest::bptest(best_model)
lmtest::bptest(lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Vet + Arrest + Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Vet + Arrest, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Vet, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp, data = suiTrain))
lmtest::bptest(lm(SuiRate~Vet, data = suiTrain))
lmtest::bptest(lm(SuiRate~Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Vet + Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Disable + Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Uninsured + Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Uninsured + Mental + Vet, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Uninsured + Mental + uxu, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Uninsured + Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Uninsured + Mental + Arrest, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Disable + Mental, data = suiTrain))
lmtest::bptest(lm(SuiRate~Unemp + Mental, data = suiTrain))
SuiBC <- caret::BoxCoxTrans((suidat$SuiRate))
install.packages("e1071")
### Errors independent and and variance about the same
plot(error_terms)
plot(y=0)
lines(y=0)
lines(x=0)
lines(x=0, color="blue")
lines(x=0, col="blue")
abline(h=0)
lmtest::bptest(best_model)
lmtest::bptest(best_model)
lmtest::bptest(best_model)
lmtest::bptest(best_model)
lmtest::bptest(best_model)
lmtest::bptest(best_model)
SuiBC <- caret::BoxCoxTrans((suidat$SuiRate))
print(SuiBC)
suidat <- cbind(suidat, Sui_new=predict(SuiBC,suidat$SuiRate))
head(suidat)
best_BC <- lm(Sui_new ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suidat)
bptest(best_BC)
bptest(best_model)
plot(best_BC)
plot(best_model)
suidat$resi <- best_model$residuals
suiTrain$resi <- best_model$residuals
varfunc.ols <- lm(log(resi^2) ~ log(Unemp)+log(Vet)+log(Arrest)+log(Disable)+log(dxu)+log(Uninsured)+log(Mental), data = suiTrain)
suidat$varfunc <- exp(varfunc.ols$fitted.values)
suiTrain$varfunc <- exp(varfunc.ols$fitted.values)
sui.gls <- lm(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=1/sqrt(varfunc),data=suiTrain)
bptest(sui.gls)
summary(sui.gls)
### Errors independent and and variance about the same
plot(error_terms)
lmtest::bptest(best_model)
plot(suiTrain$Poverty,suiTrain$SuiRate)
plot(suiTrain$Poverty,suiTrain$SuiRate)
best_robust <- lmrob(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
install.packages("robustbase")
library(robustbase)
best_robust <- lmrob(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
lmtest::bptest(best_robust)
summary(best_robust)
bptest(best_robust)
bptest(best_model)
bptest(best.gls)
bptest(sui.gls)
summary(best_model)
summary(sui.gls)
summary(best_robust)
sui.gls2 <- lm(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=1/varfunc,data=suiTrain)
bptest(sui.gls)
bptest(sui.gls2)
bptest(best_axm)
bptest(sui.gls2)
sui.gls3 <- lm(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=1/varfunc^2,data=suiTrain)
bptest(sui.gls3)
summary(sui.gls2)
summary(sui.gls3)
sui.gls4 <- lm(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=1/varfunc^3,data=suiTrain)
summary(sui.gls4)
summary(sui.gls3)
bptest(sui.gls)
best_model_without_unemp <- lm(SuiRate~ Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain)
bptest(best_model_without_unemp)
igiveup <- irls(SuiRate~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain)
install.packages("msme")
library(msmse)
library(msme)
igiveup <- irls(SuiRate~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain)
igiveup <- irls(SuiRate~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain, family="normal")
igiveup <- irls(SuiRate~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain, family="normal", link="log")
igiveup <- ml_glm2(SuiRate~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain, family = "normal", mean.link = "identity", scale.link = "log_s")
summary(igiveup)
bptest(igiveup)
igiveup <- irls(SuiRate~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain, family="normal", link="log_s")
igiveup <- irls(SuiRate~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain, family="binomial", link="log")
summary(best_model)
bptest(lm(SuiRate ~ Unemp + Vet + Arrest + Mental + Disable +
Uninsured, data = suiTrain))
summary(best_model)
summary(best_model)
bptest(lm(SuiRate <- Vet + Arrest + Mental, data = suiTrain))
bptest(lm(SuiRate ~ Vet + Arrest + Mental, data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Arrest + Mental, data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Arrest , data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Vet , data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Arrest + Uninsured , data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Arrest + Uninsured + Disable, data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Arrest + Uninsured + Mental, data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Arrest + Uninsured + Poverty, data = suiTrain))
summary(lm(SuiRate ~ Unemp + Arrest + Uninsured + Poverty, data = suiTrain))
summary(lm(SuiRate ~ Unemp + Arrest + Uninsured, data = suiTrain))
summary(lm(SuiRate ~ Vet + Arrest + Mental, data = suiTrain))
summary(lm(SuiRate ~ Vet, data = suiTrain))
bptest(lm(SuiRate ~ Vet, data = suiTrain))
bptest(lm(SuiRate ~ Unemp, data = suiTrain))
bptest(lm(SuiRate ~ Arrest, data = suiTrain))
bptest(lm(SuiRate ~ Mental, data = suiTrain))
bptest(lm(SuiRate ~ Poverty, data = suiTrain))
bptest(lm(SuiRate ~ Uninsured, data = suiTrain))
bptest(lm(SuiRate ~ Disable, data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Arrest + Mental + Uninsured, data = suiTrain))
bptest(lm(SuiRate ~ Unemp  + Mental + Uninsured, data = suiTrain))
summary(lm(SuiRate ~ Unemp  + Mental + Uninsured, data = suiTrain))
summary(lm(SuiRate ~ Unemp  + Mental + Arrest, data = suiTrain))
bptest(lm(SuiRate ~ Unemp  + Mental + Arrest, data = suiTrain))
bptest(lm(SuiRate ~ Unemp  + Uninsured + Arrest, data = suiTrain))
summary(lm(SuiRate ~ Unemp  + Uninsured + Arrest, data = suiTrain))
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
#Error term analysis
####################
error_terms <- best_model$residuals # from the fit
### Errors independent and and variance about the same
plot(error_terms)
###Approximately Normal?
hist(error_terms)
qqnorm(error_terms)
qqline(error_terms)
summary(sui.gls)
bptest(sui.gls)
bptest(best_model)
glsgls <- gls(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=varPower())
install.packages("lmne")
install.packages("nmle")
install.packages("nlme")
install.packages("nlme")
library(nlme)
glsgls <- gls(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=varPower())
glsgls <- gls(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data=suiTrain, weights=varPower())
bptest(glsgls)
summary(glsgls)
plot(glsgls)
plot(best_model)
# Generalized Least Squared model
suiTrain$resi <- best_model$residuals
varfunc.ols <- lm(log(resi^2) ~ log(Unemp)+log(Vet)+log(Arrest)+log(Disable)+log(dxu)+log(Uninsured)+log(Mental), data = suiTrain)
suiTrain$varfunc <- exp(varfunc.ols$fitted.values)
sui.gls <- lm(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=1/sqrt(varfunc),data=suiTrain)
summary(sui.gls)
summary(best_model)
summary(best_robust)
best_robust <- lmrob(formula = SuiRate ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured +
dxu, method ='SMDM',data = suiTrain)
summary(best_robust)
bptest(best_robust)
best_robust <- lmrob(formula = SuiRate ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured +
dxu, method ='M',data = suiTrain)
bptest(best_robust)
summary(best_robust)
install.packages("sandwich")
library(sandwich)
suiTrain %>% vcovHC() %>% diag() %>% sqrt()
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
suiTrain %>% vcovHC() %>% diag() %>% sqrt()
coeftest(lmfit, vcov = vcovHC(lmfit, type = "HC0"))
coeftest(suiTrain, vcov = vcovHC(lmfit, type = "HC0"))
coeftest(suiTrain, vcov = vcovHC(suiTrain, type = "HC0"))
coeftest(best_model, vcov = vcovHC(best_model, type = "HC0"))
best_model %>% vcovHC() %>% diag() %>% sqrt()
best_robust <- lmrob(formula = SuiRate ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured +
dxu,data = suiTrain)
summary(best_robust)
library(car)
install.packages("car")
library(car)
hccm(best_model)
summary(best_model, robust=T)
summary(best_model)
rm(list=lm())
rm(list=ls())
library(lmtest)
library(caret)
library(Metrics)
library(leaps)
library(robustbase)
setwd("/Users/BenMeow/Desktop/Midterm/ai-midterm")
suidat <- read.csv("/Users/BenMeow/Desktop/Midterm/ai-midterm/SuiRate.csv")
head(suidat)
#Suicide Rate Data + Variables:
#https://drive.google.com/open?id=1JFalYrbit84vgHNzYlsCnm0j2AOKyz0D#
# Split data randomly into training set and test set, each with 75% and 25% of the data respectively
set.seed(3456)
trainData <- createDataPartition(suidat$SuiRate, p=.75,list=FALSE,times=1)
suiTrain <- suidat[trainData,]
suiTest <- suidat[-trainData,]
head(suiTrain)
head(suiTest)
###Linear Response
plot(suiTrain$Unemp,suiTrain$SuiRate)
plot(suiTrain$Vet,suiTrain$SuiRate)
plot(suiTrain$Arrest,suiTrain$SuiRate)
plot(suiTrain$Mental,suiTrain$SuiRate)
plot(suiTrain$Disable,suiTrain$SuiRate)
plot(suiTrain$Uninsured,suiTrain$SuiRate)
plot(suiTrain$Poverty,suiTrain$SuiRate)
############################################################
# Best-subset Method
############################################################
best_subsets <- regsubsets(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, nbest = 1, nvmax= 7, data=suiTrain,method="exhaustive")
summary_best<- summary(best_subsets)
which.max(summary_best$adjr2)
bestsubset_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suiTrain)
############################################################
# Cross - Validation
############################################################
lmFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm")
ctrl<-trainControl(method = "cv",number = 10)
lmCVFit<-train(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + Poverty, data = suidat, method = "lm", trControl = ctrl, metric="RMSE")
summary(lmCVFit)
bestkfold_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured, data = suidat)
summary(bestkfold_model)
############################################################
# Interaction Term Analysis
############################################################
best_uxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxa, data = suiTrain)
summary(best_uxa)
best_uxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxm, data = suiTrain)
summary(best_uxm)
best_uxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxd, data = suiTrain)
summary(best_uxd)
best_uxv <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxv, data = suiTrain)
summary(best_uxv)
best_uxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + uxu, data = suiTrain)
summary(best_uxu)
best_vxa <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxa, data = suiTrain)
summary(best_vxa)
best_vxm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxm, data = suiTrain)
summary(best_vxm)
best_vxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxd, data = suiTrain)
summary(best_vxd)
best_vxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + vxu, data = suiTrain)
summary(best_vxu)
best_axm <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axm, data = suiTrain)
summary(best_axm)
best_axd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axd, data = suiTrain)
summary(best_axd)
best_axu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + axu, data = suiTrain)
summary(best_axu)
best_mxd <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxd, data = suiTrain)
summary(best_mxd)
best_mxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + mxu, data = suiTrain)
summary(best_mxu)
best_dxu <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
summary(dxu)
# The interaction term between the disable and uninsured variable increased the adjusted R square while keeping all variables statistically significant
best_model <- lm(SuiRate~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain)
summary(best_model)
#Error term analysis
####################
error_terms <- best_model$residuals # from the fit
#All the error terms
suiTrain$SuiRate - predict(best_model, suiTrain)
### Errors independent and and variance about the same
plot(error_terms)
lmtest::bptest(best_model)
###Approximately Normal?
hist(error_terms)
qqnorm(error_terms)
qqline(error_terms)
###############
# Prediction in R
###########
predict(best_model, suiTest)
suiTest$SuiRate - predict(best_model, suiTest)
# Calculate mean and standard deviation for test and training residuals
mean(suiTest$SuiRate - predict(best_model, suiTest))
sd(suiTest$SuiRate - predict(best_model, suiTest))
mean(suiTrain$SuiRate - predict(best_model, suiTrain))
sd(suiTrain$SuiRate - predict(best_model, suiTrain))
rmse(suiTest$SuiRate, predict(best_model, suiTest))
sse(suiTest$SuiRate, predict(best_model, suiTest))
mae(suiTest$SuiRate, predict(best_model, suiTest))
# Determine observation range between training and test set
min(suiTrain$SuiRate)
max(suiTrain$SuiRate)
min(suiTest$SuiRate)
max(suiTest$SuiRate)
# Generalized Least Squared Model
suiTrain$resi <- best_model$residuals
varfunc.ols <- lm(log(resi^2) ~ log(Unemp)+log(Vet)+log(Arrest)+log(Disable)+log(dxu)+log(Uninsured)+log(Mental), data = suiTrain)
suiTrain$varfunc <- exp(varfunc.ols$fitted.values)
sui.gls <- lm(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=1/sqrt(varfunc),data=suiTrain)
bptest(sui.gls)
# Robust Regression Model
best_robust <- lmrob(formula = SuiRate ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured +
dxu, data = suiTrain)
bptest(best_robust)
bptest(lm(SuiRate ~ UnempOG + Vet + Mental + Disable + Uninsured + Arrest + dxu,data=suiTrain))
bptest(lm(SuiRate ~ UnempOG ,data=suiTrain))
bptest(lm(SuiRate ~ Unemp ,data=suiTrain))
bptest(lm(SuiRate ~ UnempOG + Mental + Disable + Uninsured + Arrest + dxu,data=suiTrain))
bptest(lm(SuiRate ~ Unemp + Disable ,data=suiTrain))
bptest(lm(SuiRate ~ Unemp + Mental + Uninsured ,data=suiTrain))
plot(suiTrain$SuiRate, suiTrain$Uninsured)
plot(suiTrain$Uninsured, suiTrain$SuiRate)
best_gls <- lm(SuiRate ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain, weights=varPower())
best_gls <- gls(SuiRate ~ Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, data = suiTrain, weights=varPower())
bptest(best_gls)
bptest(lm(SuiRate ~ Vet + Arrest + Mental, data = suiTrain))
bptest(lm(SuiRate ~ Unemp + Mental + Uninsured, data = suiTrain))
#Error term analysis
####################
error_terms <- best_model$residuals # from the fit
### Errors independent and and variance about the same
plot(error_terms)
# Best linear Model
best_linear <- lm(SuiRate ~ Unemp + Mental + Uninsured, data = suiTrain)
linear_errors <- best_linear$residuals
plot(linear_errors)
bptest(lm(SuiRate ~ Vet+Arrest+Mental,data=suiTrain))
bptest(lm(SuiRate ~ Vet+Arrest,data=suiTrain))
bptest(lm(SuiRate ~ Arrest+Disable,data=suiTrain))
bptest(lm(SuiRate ~ Arrest+Disable+Uninsured,data=suiTrain))
bptest(lm(SuiRate ~ Arrest+Disable+Uninsured+Poverty,data=suiTrain))
bptest(lm(SuiRate ~ Arrest+Mental+Disable+Uninsured+Poverty,data=suiTrain))
bptest(lm(SuiRate ~ Arrest+Mental,data=suiTrain))
bptest(lm(SuiRate ~ Arrest+Disable+Uninsured+Poverty,data=suiTrain))
summary(lm(SuiRate ~ Arrest + Disable + Uninsured + Poverty, data = suiTrain))
summary(lm(SuiRate ~ Arrest + Disable + Uninsured, data = suiTrain))
summary(lm(SuiRate ~ Arrest + Disable + Poverty, data = suiTrain))
summary(lm(SuiRate ~ Arrest + Disable , data = suiTrain))
summary(lm(SuiRate ~ Arrest + Disable + Uninsured, data = suiTrain))
summary(lm(SuiRate ~ Arrest + Uninsured, data = suiTrain))
summary(lm(SuiRate ~ Arrest + Mental, data = suiTrain))
bptest(lm(SuiRate~Arrest+Mental,data=suiTrain))
bptest(lm(SuiRate~Arrest,data=suiTrain))
bptest(lm(SuiRate~Arrest+Uninsured,data=suiTrain))
summary(lm(SuiRate~Arrest+Uninsured,data=suiTrain))
bptest(lm(SuiRate~Arrest+Uninsured,data=suiTrain))
bptest(lm(SuiRate~Arrest+Poverty,data=suiTrain))
summary(lm(SuiRate~Arrest+Poverty,data=suiTrain))
summary(lm(SuiRate~Mental+Disable,data=suiTrain))
summary(lm(SuiRate~Mental+Uninsured,data=suiTrain))
summary(lm(SuiRate~Arrest+Uninsured,data=suiTrain))
summary(lm(SuiRate~Mental+Uninsured,data=suiTrain))
bptest(lm(SuiRate~Mental+Uninsured,data=suiTrain))
plot(linear_errors)
linear_errors <- best_linear$residuals
plot(linear_errors)
summary(best_linear)
# Best linear Model
best_linear <- lm(SuiRate ~  Mental + Uninsured, data = suiTrain)
summary(best_linear)
bptest(best_linear)
bptest(lm(SuiRate~Mental+Uninsured,data=suiTrain))
summary(best_linear)
varfunc.ols <- lm(log(resi^2) ~ log(Unemp)+log(Vet)+log(Arrest)+log(Disable)+log(dxu)+log(Uninsured)+log(Mental), data = suiTrain)
suiTrain$varfunc <- exp(varfunc.ols$fitted.values)
sui.gls <- lm(SuiRate ~Unemp + Vet + Arrest + Mental + Disable + Uninsured + dxu, weights=1/sqrt(varfunc),data=suiTrain)
bptest(sui.gls)
bptest(best_linear)
summary(sui.gls)
summary(best_robust)
summary(best_linear)
